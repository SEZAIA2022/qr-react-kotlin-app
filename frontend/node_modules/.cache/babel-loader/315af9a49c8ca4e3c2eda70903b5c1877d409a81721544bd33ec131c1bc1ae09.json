{"ast":null,"code":"import _objectSpread from\"/opt/myapp/qr-react-kotlin-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useLocation,useNavigate,Link}from'react-router-dom';import axios from'axios';import{FiEye,FiEyeOff}from'react-icons/fi';import{toast,ToastContainer}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CreateNewPassword=()=>{var _location$state;const location=useLocation();const navigate=useNavigate();const email=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.email)||'';const[password,setPassword]=useState('');const[confirmPassword,setConfirmPassword]=useState('');const[showPassword,setShowPassword]=useState(false);const[showConfirmPassword,setShowConfirmPassword]=useState(false);const[loading,setLoading]=useState(false);const validatePassword=pwd=>{const pwdRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;return pwdRegex.test(pwd);};const handleSubmit=async e=>{e.preventDefault();if(!password||!confirmPassword){toast.error('Please fill in both fields.');return;}if(!validatePassword(password)){toast.error('Password must be at least 8 characters and include uppercase, lowercase, a number, and a special character.');return;}if(password!==confirmPassword){toast.error('Passwords do not match.');return;}if(!email){toast.error('Missing email information. Please restart the password reset process.');return;}setLoading(true);try{const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/change_password_web_forget\"),{email,new_password:password,confirm_password:confirmPassword});if(res.status===200){const backendMessage=res.data.message||'Password updated successfully. Redirecting to login...';toast.success(backendMessage);setTimeout(()=>{navigate('/login',{replace:true});},3000);}else{const backendMessage=res.data.message||'Unexpected error occurred.';toast.error(backendMessage);}}catch(err){var _err$response,_err$response$data;const backendMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Server error.';toast.error(backendMessage);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:containerStyle,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Password\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:formStyle,children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',placeholder:\"New Password\",value:password,onChange:e=>setPassword(e.target.value),style:_objectSpread(_objectSpread({},inputStyle),{},{paddingRight:'40px'}),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowPassword(!showPassword),style:eyeButtonStyle,\"aria-label\":showPassword?'Hide password':'Show password',children:showPassword?/*#__PURE__*/_jsx(FiEyeOff,{}):/*#__PURE__*/_jsx(FiEye,{})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:showConfirmPassword?'text':'password',placeholder:\"Confirm New Password\",value:confirmPassword,onChange:e=>setConfirmPassword(e.target.value),style:_objectSpread(_objectSpread({},inputStyle),{},{paddingRight:'40px'}),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowConfirmPassword(!showConfirmPassword),style:eyeButtonStyle,\"aria-label\":showConfirmPassword?'Hide confirm password':'Show confirm password',children:showConfirmPassword?/*#__PURE__*/_jsx(FiEyeOff,{}):/*#__PURE__*/_jsx(FiEye,{})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:buttonStyle,children:loading?'Saving...':'Save Password'})]}),/*#__PURE__*/_jsxs(\"p\",{style:{marginTop:'10px'},children:[\"Remembered your password? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})]}),/*#__PURE__*/_jsx(ToastContainer,{position:\"top-center\",autoClose:4000})]});};// Styles\nconst containerStyle={maxWidth:'400px',margin:'auto',padding:'20px',backgroundColor:'#f9faff',borderRadius:'8px',boxShadow:'0 2px 10px rgba(0,0,0,0.05)',fontFamily:\"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif\"};const formStyle={display:'flex',flexDirection:'column',gap:'15px'};const inputStyle={padding:'10px',fontSize:'16px',borderRadius:'8px',border:'1.5px solid #ccc',fontFamily:'inherit',width:'100%',boxSizing:'border-box'};const eyeButtonStyle={position:'absolute',right:'10px',top:'50%',transform:'translateY(-50%)',background:'transparent',border:'none',cursor:'pointer',fontSize:'18px'};const buttonStyle={backgroundColor:'#007bff',color:'#fff',fontWeight:'bold',border:'none',padding:'12px',borderRadius:'8px',cursor:'pointer',fontSize:'16px'};export default CreateNewPassword;","map":{"version":3,"names":["React","useState","useLocation","useNavigate","Link","axios","FiEye","FiEyeOff","toast","ToastContainer","jsx","_jsx","jsxs","_jsxs","CreateNewPassword","_location$state","location","navigate","email","state","password","setPassword","confirmPassword","setConfirmPassword","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","loading","setLoading","validatePassword","pwd","pwdRegex","test","handleSubmit","e","preventDefault","error","res","post","concat","process","env","REACT_APP_API_URL","new_password","confirm_password","status","backendMessage","data","message","success","setTimeout","replace","err","_err$response","_err$response$data","response","style","containerStyle","children","onSubmit","formStyle","position","type","placeholder","value","onChange","target","_objectSpread","inputStyle","paddingRight","required","onClick","eyeButtonStyle","disabled","buttonStyle","marginTop","to","autoClose","maxWidth","margin","padding","backgroundColor","borderRadius","boxShadow","fontFamily","display","flexDirection","gap","fontSize","border","width","boxSizing","right","top","transform","background","cursor","color","fontWeight"],"sources":["/opt/myapp/qr-react-kotlin-app/frontend/src/components/CreateNewPassword.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useLocation, useNavigate, Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { FiEye, FiEyeOff } from 'react-icons/fi';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nconst CreateNewPassword = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const email = location.state?.email || '';\n\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n\n  const validatePassword = (pwd) => {\n    const pwdRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;\n    return pwdRegex.test(pwd);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!password || !confirmPassword) {\n      toast.error('Please fill in both fields.');\n      return;\n    }\n\n    if (!validatePassword(password)) {\n      toast.error('Password must be at least 8 characters and include uppercase, lowercase, a number, and a special character.');\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      toast.error('Passwords do not match.');\n      return;\n    }\n\n    if (!email) {\n      toast.error('Missing email information. Please restart the password reset process.');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/api/change_password_web_forget`, {\n        email,\n        new_password: password,\n        confirm_password: confirmPassword\n      });\n\n      if (res.status === 200) {\n        const backendMessage = res.data.message || 'Password updated successfully. Redirecting to login...';\n        toast.success(backendMessage);\n        setTimeout(() => {\n          navigate('/login', { replace: true });\n        }, 3000);\n      } else {\n        const backendMessage = res.data.message || 'Unexpected error occurred.';\n        toast.error(backendMessage);\n      }\n    } catch (err) {\n      const backendMessage = err.response?.data?.message || 'Server error.';\n      toast.error(backendMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={containerStyle}>\n      <h2>Create New Password</h2>\n\n      <form onSubmit={handleSubmit} style={formStyle}>\n        <div style={{ position: 'relative' }}>\n          <input\n            type={showPassword ? 'text' : 'password'}\n            placeholder=\"New Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            style={{ ...inputStyle, paddingRight: '40px' }}\n            required\n          />\n          <button\n            type=\"button\"\n            onClick={() => setShowPassword(!showPassword)}\n            style={eyeButtonStyle}\n            aria-label={showPassword ? 'Hide password' : 'Show password'}\n          >\n            {showPassword ? <FiEyeOff /> : <FiEye />}\n          </button>\n        </div>\n\n        <div style={{ position: 'relative' }}>\n          <input\n            type={showConfirmPassword ? 'text' : 'password'}\n            placeholder=\"Confirm New Password\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n            style={{ ...inputStyle, paddingRight: '40px' }}\n            required\n          />\n          <button\n            type=\"button\"\n            onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n            style={eyeButtonStyle}\n            aria-label={showConfirmPassword ? 'Hide confirm password' : 'Show confirm password'}\n          >\n            {showConfirmPassword ? <FiEyeOff /> : <FiEye />}\n          </button>\n        </div>\n\n        <button type=\"submit\" disabled={loading} style={buttonStyle}>\n          {loading ? 'Saving...' : 'Save Password'}\n        </button>\n      </form>\n\n      <p style={{ marginTop: '10px' }}>\n        Remembered your password? <Link to=\"/login\">Login</Link>\n      </p>\n\n      {/* Toast container obligatoire pour afficher les toasts */}\n      <ToastContainer position=\"top-center\" autoClose={4000} />\n    </div>\n  );\n};\n\n// Styles\nconst containerStyle = {\n  maxWidth: '400px',\n  margin: 'auto',\n  padding: '20px',\n  backgroundColor: '#f9faff',\n  borderRadius: '8px',\n  boxShadow: '0 2px 10px rgba(0,0,0,0.05)',\n  fontFamily: \"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif\",\n};\n\nconst formStyle = {\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '15px',\n};\n\nconst inputStyle = {\n  padding: '10px',\n  fontSize: '16px',\n  borderRadius: '8px',\n  border: '1.5px solid #ccc',\n  fontFamily: 'inherit',\n  width: '100%',\n  boxSizing: 'border-box',\n};\n\nconst eyeButtonStyle = {\n  position: 'absolute',\n  right: '10px',\n  top: '50%',\n  transform: 'translateY(-50%)',\n  background: 'transparent',\n  border: 'none',\n  cursor: 'pointer',\n  fontSize: '18px',\n};\n\nconst buttonStyle = {\n  backgroundColor: '#007bff',\n  color: '#fff',\n  fontWeight: 'bold',\n  border: 'none',\n  padding: '12px',\n  borderRadius: '8px',\n  cursor: 'pointer',\n  fontSize: '16px',\n};\n\nexport default CreateNewPassword;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}